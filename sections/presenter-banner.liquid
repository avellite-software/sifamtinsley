{% comment %}
  Section: Presenter Banner
  - V3: Interactive gradient background & Glass content box.
  - Updates: Larger glow, off-center default position, white text default.
{% endcomment %}

{%- style -%}
  .presenter-section-{{ section.id }} {
    display: flex;
    align-items: center;
    position: relative;
    background-color: #111; /* Fallback color */
    border-bottom-right-radius: 50px;
    overflow: hidden;
    /* Initialize variables for mouse position (Default: Bottom Left) */
    --mouse-x: 20%;
    --mouse-y: 80%;
  }

  /* Interactive Background Layer
     - Uses CSS variables set by JS to move the gradient.
  */
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    pointer-events: none;
    /* The Gradient: Larger Red glow following mouse, fading to dark */
    background: radial-gradient(
      1200px circle at var(--mouse-x) var(--mouse-y),
      rgba(193, 21, 27, 0.4),
      transparent 60%
    );
    /* Add a subtle second animation for when mouse isn't moving */
    animation: pulse-glow 10s infinite alternate;
  }

  /* Keyframes to keep it alive even without mouse movement */
  @keyframes pulse-glow {
    0% { opacity: 0.8; }
    100% { opacity: 1; }
  }

  /* Height Options */
  .presenter-section--small { min-height: 250px; }
  .presenter-section--medium { min-height: 400px; }
  .presenter-section--large { min-height: 550px; }

  /* Content Layout */
  .presenter-section__content-wrapper {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1.5rem;
    width: 100%;
    position: relative;
    z-index: 2; /* Above the background */
  }

  /* Glass Box Styles */
  .presenter-section__content {
    text-align: left;
    color: {{ section.settings.text_color }};
    max-width: 700px;

    /* Glass Effect */
    background: rgba(255, 255, 255, 0.05); /* Very subtle white tint */
    backdrop-filter: blur(16px); /* Strong blur */
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 16px;
    padding: 3rem;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
  }

  .presenter-section__title {
    font-size: 32px;
    font-weight: 700;
    line-height: 1.2;
    margin-bottom: 1rem;
    color: inherit;
  }

  .presenter-section__description {
    font-size: 16px;
    line-height: 1.6;
    max-width: 100%;
    color: inherit;
    opacity: 0.9;
  }
  .presenter-section__description p {
    margin: 0;
  }

  @media screen and (max-width: 768px) {
    .presenter-section__content {
      text-align: center;
      padding: 2rem;
      margin: 0 auto; /* Center the box itself */
    }
  }
{%- endstyle -%}

{%- liquid
  assign presenter_title = section.settings.title
  if presenter_title == blank
    if product.title != blank
      assign presenter_title = product.title
    elsif collection.title != blank
      assign presenter_title = collection.title
    elsif page.title != blank
      assign presenter_title = page.title
    else
      assign presenter_title = 'Welcome'
    endif
  endif

  assign presenter_description = section.settings.description
  if presenter_description == blank and page_description != blank
    assign presenter_description = '<p>' | append: page_description | append: '</p>'
  endif
-%}

<div
  id="presenter-{{ section.id }}"
  class="presenter-section presenter-section-{{ section.id }} presenter-section--{{ section.settings.height }}"
>
  {% comment %}
    Interactive Background Container
    (Contains empty div to prevent Shopify hiding it)
  {% endcomment %}
  <div class="presenter-interactive-bg">
    <div></div>
  </div>

  <div class="presenter-section__content-wrapper">
    <div class="presenter-section__content">
      {%- if presenter_title != blank -%}
        <h1 class="presenter-section__title">{{ presenter_title }}</h1>
      {%- endif -%}

      {%- if presenter_description != blank -%}
        <div class="presenter-section__description rte">
          {{ presenter_description }}
        </div>
      {%- endif -%}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const section = document.querySelector('.presenter-section-{{ section.id }}');
    if (!section) return;

    section.addEventListener('mousemove', (e) => {
      const rect = section.getBoundingClientRect();
      // Calculate mouse position relative to the section
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      // Update CSS variables
      section.style.setProperty('--mouse-x', `${x}px`);
      section.style.setProperty('--mouse-y', `${y}px`);
    });
  });
</script>

{% schema %}
{
  "name": "Presenter Banner",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "info": "Leave blank to use current page title."
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "info": "Leave blank to use SEO description."
    },
    {
      "type": "header",
      "content": "Layout & Style"
    },
    {
      "type": "select",
      "id": "height",
      "label": "Section height",
      "options": [
        { "value": "small", "label": "Small" },
        { "value": "medium", "label": "Medium" },
        { "value": "large", "label": "Large" }
      ],
      "default": "medium"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#FFFFFF"
    },
    {
      "type": "header",
      "content": "Background"
    },
    {
      "type": "paragraph",
      "content": "This section uses an interactive gradient background."
    }
  ],
  "presets": [
    {
      "name": "Presenter Banner"
    }
  ]
}
{% endschema %}
